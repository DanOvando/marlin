<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Fast simulation of marine fauna and fisheries. Runs multiple (independent) age structured species simultaneously in 2D">
<title>Simulation of Ocean Fisheries • marlin</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Simulation of Ocean Fisheries">
<meta property="og:description" content="Fast simulation of marine fauna and fisheries. Runs multiple (independent) age structured species simultaneously in 2D">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">marlin</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/MSE.html">MSE</a>
    <a class="dropdown-item" href="articles/dynamic-habitat.html">dynamic-habitat</a>
    <a class="dropdown-item" href="articles/fleet-management.html">fleet-management</a>
    <a class="dropdown-item" href="articles/optimize-mpas.html">optimize-mpas</a>
    <a class="dropdown-item" href="articles/port-distance.html">port-distance</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/danovando/marlin/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="marlin">marlin<a class="anchor" aria-label="anchor" href="#marlin"></a>
</h1></div>
<!-- badges: start -->
<!-- [![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental) -->
<!-- [![CRAN status](https://www.r-pkg.org/badges/version/mar)](https://CRAN.R-project.org/package=mar) -->
<!-- badges: end -->
<p><code>marlin</code> is a package for efficiently running simulations of marine fauna and fisheries. It can track the age-structured populations of multiple independent animals targeted by multiple fishing fleets across a two dimensional space. It allows users to simulate a wide range of life histories, movement dynamics, fishing fleet behaviors, and management strategies. See examples below and vignettes under the articles tab for how to use <code>marlin</code> to do things like simulate… - the impacts of displaced fishing effort across multiple species - seasonal spawning aggregations or climate induced range shifts - the impacts of port distance in fleet dynamics - optimized marine protected area network design</p>
<div class="section level2">
<h2 id="what-is-marlin-for">What is <code>marlin</code> for?<a class="anchor" aria-label="anchor" href="#what-is-marlin-for"></a>
</h2>
<p><code>marlin</code> is best suited for asking <em>what if</em> rather that <em>what will</em> questions. In other words, <code>marlin</code> is better suited to asking “how might the design or impacts of my proposed MPA network change if fishing effort is displaced rather than removed?” rather than “<em>what will</em> the impacts of my proposed MPA network be on biodiversity down to the 6th decimal place”. This is because <code>marlin</code> is a <em>structural</em> rather than <em>statistical</em> simulation model, meaning it cannot by fit to explain processes in observed data. Rather, users must manually adjust the parameters of the model to reflect the general dynamics of the system they are interested in. This means that “how much of an impact does hyperallometry have on MPA outcomes” is a much simpler question than “what will be the catch and biodiversity impacts of the MPA I am designing for 13 different data-limited species in a rapidly changing small bay”. Both are doable, and marlin can provide general insights in both cases, but the more specific and <em>what will</em> style question you ask, the harder it will be to ensure the model is appropriately set up.</p>
<p>Some use cases we envision for marlin are</p>
<ul>
<li><p>Assessing sensitivity of MPA network designs to key ecological and economic unknowns</p></li>
<li><p>Design of dynamic ocean management strategies under climate change</p></li>
<li><p>Management strategy evaluation of spatially-explicit fisheries management</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version from <a href="https://github.com/" class="external-link">GitHub</a> using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"DanOvando/marlin"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="installation-troubleshooting">Installation Troubleshooting<a class="anchor" aria-label="anchor" href="#installation-troubleshooting"></a>
</h3>
<p>Make sure you try the install with a fresh R session (go to “Session&gt;Restart R” to make sure)</p>
<p>If you run into an error, first off try updating your R packages. From there….</p>
<p>If your version of R is lower than 4.0, you might want to consider updating R itself.</p>
<p>From there…</p>
<ul>
<li>On Windows, make sure you have the appropriate version of Rtools installed (<a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">here</a>), most likely Rtools4X if you have R version 4.X
<ul>
<li>Make sure that you select the box that says something about adding Rtools to the PATH variable</li>
</ul>
</li>
<li>On macOS, there might be some issues with the your compiler, particularly if your version of R is less than 4.0.0.</li>
</ul>
<p>If you get an error that says something like <code>clang: error: unsupported option '-fopenmp'</code>, follow the instructions <a href="https://thecoatlessprofessor.com/programming/cpp/r-compiler-tools-for-rcpp-on-macos-before-r-4.0.0/" class="external-link">here</a></p>
<p>Once you’ve tried those, restart your computer and try running re-installing <code>marlin</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="a-caveat">A Caveat<a class="anchor" aria-label="anchor" href="#a-caveat"></a>
</h2>
<p><code>marlin</code> is designed to be fast and relatively user friendly, at least for the complexity of the modeling it enables users to do. However, it is not a tool for fully automated MPA design; users will still need to be able to understand the core functionality of the model, and mileage with the model will depend greatly on the creativity and R skills of the user.</p>
<p>In particular, while we provide some wrappers for organizing common outputs and plots, <code>marlin</code> produces far more outputs, and is designed for more use cases, than we can preemptively plan for.</p>
<p>Given that <code>marlin</code> tracks populations and fleet dynamics across ages, time steps, space, species, and fleet units, the outputs are rather unruly. Skills in wrangling list objects will serve you will, along with tidy-data manipulation.</p>
<p>You do not need the <code>tidyverse</code> to run <code>marlin</code>, but you will see that we make extensive use of it, in particular <code>dplyr</code>, <code>tidyr</code>, <code>ggplot2</code> and <code>purrr</code> in the examples below, to extract useful results from <code>marlin</code>.</p>
</div>
<div class="section level2">
<h2 id="simple-example">Simple Example<a class="anchor" aria-label="anchor" href="#simple-example"></a>
</h2>
<p>Let’s start with a simple one-fleet one-critter example to illustrate the various options in <code>marlin</code>.</p>
<p>Some of the core options for <code>marlin</code></p>
<ul>
<li><p><code>resolution</code>: the number of patches to a side of the 2D population grid. So, setting a resolution of 10 means you will be simulating a 10x10 system, i.e. 100 patches</p></li>
<li><p><code>years</code>: the number of years to run the simulation</p></li>
<li><p><code>seasons</code>: the number of seasons per year. 2 would mean that each year is divided into two time steps, 4 would mean a quarterly model, 12 a monthly model, etc.</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://danovando.github.io/marlin/">marlin</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>dplyr.summarise.inform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu">marlin</span><span class="fu">::</span><span class="fu"><a href="reference/theme_marlin.html">theme_marlin</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">42</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">resolution</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co"># resolution is in squared patches, so 20 implies a 20X20 system, i.e. 400 patches </span></span>
<span></span>
<span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="va">seasons</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">time_step</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">seasons</span></span>
<span></span>
<span><span class="va">steps</span> <span class="op">&lt;-</span> <span class="va">years</span> <span class="op">*</span> <span class="va">seasons</span></span></code></pre></div>
<p>From there, <code>marlin</code> works be specifying three list objects</p>
<ul>
<li><p><code>fauna</code>: a list object of the life histories of the different species being simulated</p></li>
<li><p><code>fleets</code>: a list object of the fleet dynamics to be simulated</p></li>
<li><p><code>manager</code>: a list of the management strategies being employed</p></li>
</ul>
<p>The <code>fauna</code> object is a list with individual slots for every “critter” you want to simulate, created by the <code>create_critter</code> function. If you supply a common or scientific name, the model will try and populate the life history values for your species based on the values reported in <a href="https://github.com/James-Thorson-NOAA/FishLife" class="external-link">FishLife</a>, though for more specific applications you should always check these values and replace them with more local and specific values as needed.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fauna</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"bigeye"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      common_name <span class="op">=</span> <span class="st">"bigeye tuna"</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fl">10</span>,</span>
<span>      rec_form <span class="op">=</span> <span class="fl">3</span>,</span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      fished_depletion <span class="op">=</span> <span class="fl">.25</span>,</span>
<span>      resolution <span class="op">=</span> <span class="va">resolution</span>,</span>
<span>      steepness <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>      ssb0 <span class="op">=</span> <span class="fl">1000</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; ══  1 queries  ═══════════════</span></span>
<span><span class="co">#&gt; ✔  Found:  bigeye+tuna[Common Name]</span></span>
<span><span class="co">#&gt; ══  Results  ═════════════════</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • Total: 1 </span></span>
<span><span class="co">#&gt; • Found: 1 </span></span>
<span><span class="co">#&gt; • Not Found: 0</span></span>
<span></span>
<span><span class="va">fauna</span><span class="op">$</span><span class="va">bigeye</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
<p>The <code>fleets</code> object is a list of individual fishing fleets created by the <code>create_fleet</code> function. Importantly, each fleet is broken up into metiers specifying the dynamics of a fishing fleet with regards to a matching critter in the <code>fauna</code> object. So, in this case we have a longline fleet, with a metier for bigeye tuna specifying things like the price per unit weight, selectivity, and p_explt. <code>p_explt</code> tracks the relative exploitation of each metier in the total exploitation of each species. So, if one metier has a <code>p_explt</code> of 1 for species X, and another a <code>p_explt</code> of 2 for the same species, 50% of the mortality for species X comes from the first metier (p_explt values are relative, not absolute).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"longline"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_fleet.html">create_fleet</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"bigeye"</span> <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>        critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">bigeye</span>,</span>
<span>        price <span class="op">=</span> <span class="fl">10</span>,</span>
<span>        sel_form <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>        sel_start <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        sel_delta <span class="op">=</span> <span class="fl">.01</span>,</span>
<span>        catchability <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        p_explt <span class="op">=</span> <span class="fl">1</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    base_effort <span class="op">=</span> <span class="va">resolution</span> <span class="op">^</span> <span class="fl">2</span>,</span>
<span>    resolution <span class="op">=</span> <span class="va">resolution</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We then use the <code>tune_fleets</code> function as needed to tune the dynamics of the fleet to achieve specific objectives. In this case, we specified a target equilibrium fished depletion of 25% (meaning biomass at equilibrium is 25% of unfished biomass). <code>tune_fleets</code> adjusts the catchability coefficients by fleet to achieve the desired depletion level, taking into account the dynamics and <code>p_explt</code> values per metier.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tune_fleets.html">tune_fleets</a></span><span class="op">(</span><span class="va">fauna</span>, <span class="va">fleets</span>, tune_type <span class="op">=</span> <span class="st">"depletion"</span><span class="op">)</span> </span></code></pre></div>
<p>From there, we run the simulation by passing the <code>fauna</code> and <code>fleet</code> options to the <code>simmar</code> function</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">start_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">example_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simmar.html">simmar</a></span><span class="op">(</span>fauna <span class="op">=</span> <span class="va">fauna</span>,</span>
<span>                  fleets <span class="op">=</span> <span class="va">fleets</span>,</span>
<span>                  years <span class="op">=</span> <span class="va">years</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">start_time</span></span>
<span><span class="co">#&gt; Time difference of 0.04281306 secs</span></span></code></pre></div>
<p>we can then use <code>process_marlin</code> and <code>plot_marlin</code> to examine the simulation</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">processed_marlin</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/process_marlin.html">process_marlin</a></span><span class="op">(</span>sim <span class="op">=</span> <span class="va">example_sim</span>, time_step <span class="op">=</span> <span class="va">time_step</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-1.png" width="100%"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span>, plot_var <span class="op">=</span> <span class="st">"c"</span>, max_scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-2.png" width="100%"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span>, plot_var <span class="op">=</span> <span class="st">"n"</span>, plot_type <span class="op">=</span> <span class="st">"length"</span>, fauna <span class="op">=</span> <span class="va">fauna</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-3.png" width="100%"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span>, plot_var <span class="op">=</span> <span class="st">"ssb"</span>, plot_type <span class="op">=</span> <span class="st">"space"</span>, steps_to_plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">processed_marlin</span><span class="op">$</span><span class="va">fauna</span><span class="op">$</span><span class="va">step</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-4.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="simple-example-seasonal-habitat-and-movement-and-spatial-q">Simple Example: seasonal habitat and movement and spatial q<a class="anchor" aria-label="anchor" href="#simple-example-seasonal-habitat-and-movement-and-spatial-q"></a>
</h2>
<p>Now let’s add in different adult habitats by season, different movement rates by season, specified recruitment habitat, and a spatial dimension to catchability, and quarterly time steps</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">seasons</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span></span>
<span><span class="va">time_step</span> <span class="op">&lt;-</span>  <span class="fl">1</span> <span class="op">/</span> <span class="va">seasons</span></span>
<span></span>
<span><span class="va">bigeye_habitat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">+</span> <span class="va">y</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span>, <span class="fl">300</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">bigeye_habitat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">^</span> <span class="fl">.2</span> <span class="op">+</span> <span class="va">y</span> <span class="op">^</span> <span class="fl">.2</span><span class="op">)</span>, <span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bigeye_q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">resolution</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">fauna</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"bigeye"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      common_name <span class="op">=</span> <span class="st">"bigeye tuna"</span>,</span>
<span>      base_habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">bigeye_habitat</span>,<span class="va">bigeye_habitat2</span><span class="op">)</span>,</span>
<span>      season_blocks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="fl">.1</span><span class="op">)</span><span class="op">)</span>, <span class="co"># standard deviation of the number of patches moved by adults</span></span>
<span>      rec_form <span class="op">=</span> <span class="fl">2</span>,</span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      init_explt <span class="op">=</span>  <span class="fl">1</span>,</span>
<span>     explt_type <span class="op">=</span> <span class="st">"f"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; ══  1 queries  ═══════════════</span></span>
<span><span class="co">#&gt; ✔  Found:  bigeye+tuna[Common Name]</span></span>
<span><span class="co">#&gt; ══  Results  ═════════════════</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • Total: 1 </span></span>
<span><span class="co">#&gt; • Found: 1 </span></span>
<span><span class="co">#&gt; • Not Found: 0</span></span>
<span></span>
<span></span>
<span><span class="co"># create a fleets object, which is a list of lists (of lists). Each fleet has one element, </span></span>
<span><span class="co"># with lists for each species inside there. Price specifies the price per unit weight of that </span></span>
<span><span class="co"># species for that fleet</span></span>
<span><span class="co"># sel_form can be one of logistic or dome</span></span>
<span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"longline"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_fleet.html">create_fleet</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"bigeye"</span> <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>        critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">bigeye</span>,</span>
<span>        price <span class="op">=</span> <span class="fl">10</span>,</span>
<span>        sel_form <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>        sel_start <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        sel_delta <span class="op">=</span> <span class="fl">.01</span>,</span>
<span>        catchability <span class="op">=</span> <span class="fl">1e-3</span>,</span>
<span>        p_explt <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        spatial_catchability <span class="op">=</span> <span class="cn">NA</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    base_effort <span class="op">=</span> <span class="va">resolution</span> <span class="op">^</span> <span class="fl">2</span>,</span>
<span>        resolution <span class="op">=</span> <span class="va">resolution</span></span>
<span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tune_fleets.html">tune_fleets</a></span><span class="op">(</span><span class="va">fauna</span>, <span class="va">fleets</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 2.002918 secs</span></span>
<span></span>
<span></span>
<span><span class="va">fauna</span><span class="op">$</span><span class="va">bigeye</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="100%"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simmar.html">simmar</a></span><span class="op">(</span>fauna <span class="op">=</span> <span class="va">fauna</span>,</span>
<span>                  fleets <span class="op">=</span> <span class="va">fleets</span>,</span>
<span>                  years <span class="op">=</span> <span class="va">years</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 0.237659 secs</span></span>
<span>  </span>
<span></span>
<span><span class="va">processed_marlin</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/process_marlin.html">process_marlin</a></span><span class="op">(</span>sim <span class="op">=</span> <span class="va">sim2</span>, time_step <span class="op">=</span> <span class="va">time_step</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-2.png" width="100%"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span>, plot_var <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-3.png" width="100%"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span>, plot_var <span class="op">=</span> <span class="st">"n"</span>, plot_type <span class="op">=</span> <span class="st">"length"</span>, fauna <span class="op">=</span> <span class="va">fauna</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-4.png" width="100%"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span>, plot_var <span class="op">=</span> <span class="st">"ssb"</span>, plot_type <span class="op">=</span> <span class="st">"space"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-5.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="two-species-and-two-fleets-with-bells-and-whistles">Two Species and two fleets with bells and whistles<a class="anchor" aria-label="anchor" href="#two-species-and-two-fleets-with-bells-and-whistles"></a>
</h2>
<p>Now, let’s make this a two species and two fleet example with some seasonal dynamics</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">seasons</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span></span>
<span><span class="va">steps</span> <span class="op">&lt;-</span> <span class="va">years</span> <span class="op">*</span> <span class="va">seasons</span></span>
<span></span>
<span><span class="va">time_step</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">seasons</span></span>
<span><span class="co"># for now make up some habitat</span></span>
<span></span>
<span></span>
<span><span class="va">skipjack_habitat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">+</span> <span class="va">y</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span>, <span class="fl">20</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">bigeye_habitat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">+</span> <span class="va">y</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span>, <span class="fl">300</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">bigeye_habitat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">^</span> <span class="fl">.2</span> <span class="op">+</span> <span class="va">y</span> <span class="op">^</span> <span class="fl">.2</span><span class="op">)</span>, <span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fauna</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"skipjack"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      scientific_name <span class="op">=</span> <span class="st">"Katsuwonus pelamis"</span>,</span>
<span>      base_habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">skipjack_habitat</span>, <span class="va">skipjack_habitat</span><span class="op">)</span>, <span class="co"># pass habitat as lists</span></span>
<span>      season_blocks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>, <span class="co"># seasons each habitat apply to</span></span>
<span>      recruit_habitat <span class="op">=</span> <span class="va">skipjack_habitat</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fl">2</span>, <span class="co"># standard deviation of the number of patches moved by adults</span></span>
<span>      fished_depletion <span class="op">=</span> <span class="fl">.6</span>, <span class="co"># desired equilibrium depletion with fishing (1 = unfished, 0 = extinct),</span></span>
<span>      rec_form <span class="op">=</span> <span class="fl">1</span>, <span class="co"># recruitment form, where 1 implies local recruitment</span></span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      init_explt <span class="op">=</span> <span class="fl">0.2</span>, </span>
<span>      explt_type <span class="op">=</span> <span class="st">"f"</span></span>
<span>      <span class="op">)</span>,</span>
<span>    <span class="st">"bigeye"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      common_name <span class="op">=</span> <span class="st">"bigeye tuna"</span>,</span>
<span>      base_habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">bigeye_habitat</span>, <span class="va">bigeye_habitat2</span><span class="op">)</span>, <span class="co"># pass habitat as lists</span></span>
<span>      season_blocks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>, <span class="co"># seasons each habitat apply to</span></span>
<span>      recruit_habitat <span class="op">=</span> <span class="va">bigeye_habitat</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      fished_depletion <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>      rec_form <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      init_explt <span class="op">=</span> <span class="fl">0.3</span>, </span>
<span>      explt_type <span class="op">=</span> <span class="st">"f"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; ══  1 queries  ═══════════════</span></span>
<span><span class="co">#&gt; ✔  Found:  bigeye+tuna[Common Name]</span></span>
<span><span class="co">#&gt; ══  Results  ═════════════════</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • Total: 1 </span></span>
<span><span class="co">#&gt; • Found: 1 </span></span>
<span><span class="co">#&gt; • Not Found: 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 1.134254 secs</span></span>
<span></span>
<span><span class="co"># create a fleets object, which is a list of lists (of lists). Each fleet has one element, </span></span>
<span><span class="co"># with lists for each species inside there. Price specifies the price per unit weight of that </span></span>
<span><span class="co"># species for that fleet</span></span>
<span><span class="co"># sel_form can be one of logistic or dome</span></span>
<span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"longline"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_fleet.html">create_fleet</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       <span class="st">"skipjack"</span> <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>        critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">skipjack</span>,</span>
<span>        price <span class="op">=</span> <span class="fl">100</span>,</span>
<span>        <span class="co"># price per unit weight</span></span>
<span>        sel_form <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>        <span class="co"># selectivity form, one of logistic or dome</span></span>
<span>        sel_start <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>        <span class="co"># percentage of length at maturity that selectivity starts</span></span>
<span>        sel_delta <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>        <span class="co"># additional percentage of sel_start where selectivity asymptotes</span></span>
<span>        catchability <span class="op">=</span> <span class="fl">.01</span>,</span>
<span>        <span class="co"># overwritten by tune_fleet but can be set manually here</span></span>
<span>        p_explt <span class="op">=</span> <span class="fl">1</span></span>
<span>      <span class="op">)</span>,</span>
<span>       <span class="st">"bigeye"</span> <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>        critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">bigeye</span>,</span>
<span>        price <span class="op">=</span> <span class="fl">10</span>,</span>
<span>        sel_form <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>        sel_start <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>        sel_delta <span class="op">=</span> <span class="fl">.01</span>,</span>
<span>        catchability <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        p_explt <span class="op">=</span> <span class="fl">1</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    base_effort <span class="op">=</span> <span class="va">resolution</span> <span class="op">^</span> <span class="fl">2</span>,</span>
<span>        resolution <span class="op">=</span> <span class="va">resolution</span></span>
<span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"purseseine"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_fleet.html">create_fleet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    skipjack <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>      critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">skipjack</span>,</span>
<span>      price <span class="op">=</span> <span class="fl">100</span>,</span>
<span>      sel_form <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>      sel_start <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>      sel_delta <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>      catchability <span class="op">=</span> <span class="fl">.01</span>,</span>
<span>      p_explt <span class="op">=</span> <span class="fl">0.9</span></span>
<span>    <span class="op">)</span>,</span>
<span>    bigeye <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>      critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">bigeye</span>,</span>
<span>      price <span class="op">=</span> <span class="fl">100</span>,</span>
<span>      sel_form <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>      sel_start <span class="op">=</span> <span class="fl">.25</span>,</span>
<span>      sel_delta <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>      catchability <span class="op">=</span> <span class="fl">.01</span>,</span>
<span>      p_explt <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  base_effort <span class="op">=</span> <span class="va">resolution</span> <span class="op">^</span> <span class="fl">2</span>,    resolution <span class="op">=</span> <span class="va">resolution</span></span>
<span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tune_fleets.html">tune_fleets</a></span><span class="op">(</span><span class="va">fauna</span>, <span class="va">fleets</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 3.399425 secs</span></span>
<span></span>
<span></span>
<span><span class="co"># run simulations</span></span>
<span></span>
<span><span class="co"># run the simulation using marlin::simmar</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simmar.html">simmar</a></span><span class="op">(</span>fauna <span class="op">=</span> <span class="va">fauna</span>,</span>
<span>                  fleets <span class="op">=</span> <span class="va">fleets</span>,</span>
<span>                  years <span class="op">=</span> <span class="va">years</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 0.6005359 secs</span></span>
<span><span class="co"># a &lt;- Sys.time()</span></span>
<span></span>
<span><span class="va">processed_marlin</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/process_marlin.html">process_marlin</a></span><span class="op">(</span>sim <span class="op">=</span> <span class="va">sim3</span>, time_step <span class="op">=</span> <span class="va">time_step</span>, keep_age <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Sys.time() - a</span></span>
<span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example-1.png" width="100%"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span>, plot_var <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example-2.png" width="100%"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span>, plot_var <span class="op">=</span> <span class="st">"n"</span>, plot_type <span class="op">=</span> <span class="st">"length"</span>, fauna <span class="op">=</span> <span class="va">fauna</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example-3.png" width="100%"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span>, plot_var <span class="op">=</span> <span class="st">"ssb"</span>, plot_type <span class="op">=</span> <span class="st">"space"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example-4.png" width="100%"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span>  <span class="va">e_p_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">sim3</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sim3</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>,<span class="st">"e_p_fl"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"critter"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">critter</span>, names_to <span class="op">=</span> <span class="st">"fleet"</span>, values_to <span class="op">=</span> <span class="st">"effort"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">critter</span>, <span class="va">fleet</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>patch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">effort</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">fleet</span>, <span class="va">patch</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>effort <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">effort</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="evaluating-mpas">Evaluating MPAs<a class="anchor" aria-label="anchor" href="#evaluating-mpas"></a>
</h2>
<p>Now let’s compare the effect of an MPA on two species: a shark population and a yellowfin tuna population. In one simulation, the sharks and the tuna will share the same habitat. In the second, the tunas life onshore, but the sharks live further offshore. In both, we will design an MPA based on the distribution of tunas.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://danovando.github.io/marlin/">marlin</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu">marlin</span><span class="fu">::</span><span class="fu"><a href="reference/theme_marlin.html">theme_marlin</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">resolution</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># resolution is in squared patches, so 20 implies a 20X20 system, i.e. 400 patches </span></span>
<span></span>
<span><span class="va">seasons</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span></span>
<span><span class="va">tune_type</span> <span class="op">&lt;-</span> <span class="st">"depletion"</span></span>
<span></span>
<span><span class="va">steps</span> <span class="op">&lt;-</span> <span class="va">years</span> <span class="op">*</span> <span class="va">seasons</span></span>
<span></span>
<span><span class="co"># for now make up some habitat</span></span>
<span></span>
<span><span class="va">yft_habitat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="fl">.05</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span> </span>
<span></span>
<span><span class="va">mako_habitat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">resolution</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># create a fauna object, which is a list of lists</span></span>
<span><span class="va">fauna</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"Yellowfin Tuna"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      scientific_name <span class="op">=</span> <span class="st">"Thunnus albacares"</span>,</span>
<span>      base_habitat <span class="op">=</span> <span class="va">yft_habitat</span>, <span class="co"># pass habitat as lists</span></span>
<span>      recruit_habitat <span class="op">=</span> <span class="va">yft_habitat</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fl">4</span>, <span class="co"># standard deviation of the number of patches moved by adults</span></span>
<span>      fished_depletion <span class="op">=</span> <span class="fl">.4</span>, <span class="co"># desired equilibrium depletion with fishing (1 = unfished, 0 = extinct),</span></span>
<span>      rec_form <span class="op">=</span> <span class="fl">1</span>, <span class="co"># recruitment form, where 1 implies local recruitment</span></span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      init_explt <span class="op">=</span> <span class="fl">0.12</span>, </span>
<span>      explt_type <span class="op">=</span> <span class="st">"f"</span></span>
<span>      <span class="op">)</span>,</span>
<span>    <span class="st">"Shortfin Mako"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      scientific_name <span class="op">=</span> <span class="st">"Isurus oxyrinchus"</span>,</span>
<span>      base_habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mako_habitat</span><span class="op">)</span>, <span class="co"># pass habitat as lists</span></span>
<span>      recruit_habitat <span class="op">=</span> <span class="va">mako_habitat</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fl">3</span>,</span>
<span>      fished_depletion <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>      rec_form <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      burn_years <span class="op">=</span> <span class="fl">200</span>,</span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      init_explt <span class="op">=</span> <span class="fl">.12</span>, </span>
<span>      explt_type <span class="op">=</span> <span class="st">"f"</span>,</span>
<span>      fec_form <span class="op">=</span> <span class="st">"pups"</span>,</span>
<span>      pups <span class="op">=</span> <span class="fl">2</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">fauna</span><span class="op">$</span><span class="va">`Shortfin Mako`</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="100%"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a fleets object, which is a list of lists (of lists). Each fleet has one element, </span></span>
<span><span class="co"># with lists for each species inside there. Price specifies the price per unit weight of that </span></span>
<span><span class="co"># species for that fleet</span></span>
<span><span class="co"># sel_form can be one of logistic or dome</span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"longline"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_fleet.html">create_fleet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  `Yellowfin Tuna` <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>    critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">`Yellowfin Tuna`</span>,</span>
<span>    price <span class="op">=</span> <span class="fl">100</span>, <span class="co"># price per unit weight</span></span>
<span>    sel_form <span class="op">=</span> <span class="st">"logistic"</span>, <span class="co"># selectivity form, one of logistic or dome</span></span>
<span>    sel_start <span class="op">=</span> <span class="fl">.3</span>, <span class="co"># percentage of length at maturity that selectivity starts</span></span>
<span>    sel_delta <span class="op">=</span> <span class="fl">.1</span>, <span class="co"># additional percentage of sel_start where selectivity asymptotes</span></span>
<span>    catchability <span class="op">=</span> <span class="fl">.01</span>, <span class="co"># overwritten by tune_fleet but can be set manually here</span></span>
<span>    p_explt <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span>,</span>
<span>  `Shortfin Mako` <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>    critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">`Shortfin Mako`</span>,</span>
<span>    price <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    sel_form <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>    sel_start <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>    sel_delta <span class="op">=</span> <span class="fl">.01</span>,</span>
<span>    catchability <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    p_explt <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span><span class="op">)</span>,</span>
<span>  mpa_response <span class="op">=</span> <span class="st">"stay"</span>,</span>
<span>  base_effort <span class="op">=</span> <span class="va">resolution</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>  resolution <span class="op">=</span> <span class="va">resolution</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tune_fleets.html">tune_fleets</a></span><span class="op">(</span><span class="va">fauna</span>, <span class="va">fleets</span>, tune_type <span class="op">=</span> <span class="va">tune_type</span><span class="op">)</span> <span class="co"># tunes the catchability by fleet to achieve target depletion</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 21.19382 secs</span></span>
<span></span>
<span><span class="co"># run simulations</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nearshore</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simmar.html">simmar</a></span><span class="op">(</span>fauna <span class="op">=</span> <span class="va">fauna</span>,</span>
<span>                  fleets <span class="op">=</span> <span class="va">fleets</span>,</span>
<span>                  years <span class="op">=</span> <span class="va">years</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 0.4395318 secs</span></span>
<span>  </span>
<span><span class="va">proc_nearshore</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/process_marlin.html">process_marlin</a></span><span class="op">(</span><span class="va">nearshore</span>, time_step <span class="op">=</span>  <span class="va">fauna</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time_step</span><span class="op">)</span></span></code></pre></div>
<p>We will now design and implement an MPA network by specifying a data frame with columns x,y, and mpa denoting the coordinates of MPA patches.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="co">#specify some MPA locations</span></span>
<span><span class="va">mpa_locations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>mpa <span class="op">=</span> <span class="va">x</span> <span class="op">&gt;</span> <span class="fl">15</span> <span class="op">&amp;</span> <span class="va">y</span> <span class="op">&lt;</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mpa_locations</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, fill <span class="op">=</span> <span class="va">mpa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Accent"</span>, direction  <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, name <span class="op">=</span> <span class="st">"MPA"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Lat"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Lon"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-10-1.png" width="100%"></p>
<p>We will now simulate the impacts of those MPAs by passing them to the manager slot.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nearshore_mpa</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simmar.html">simmar</a></span><span class="op">(</span></span>
<span>  fauna <span class="op">=</span> <span class="va">fauna</span>,</span>
<span>  fleets <span class="op">=</span> <span class="va">fleets</span>,</span>
<span>  years <span class="op">=</span> <span class="va">years</span>,</span>
<span>  manager <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mpas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>locations <span class="op">=</span> <span class="va">mpa_locations</span>,</span>
<span>              mpa_year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">years</span> <span class="op">*</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 0.3704839 secs</span></span>
<span></span>
<span><span class="va">proc_nearshore_mpa</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/process_marlin.html">process_marlin</a></span><span class="op">(</span><span class="va">nearshore_mpa</span>, time_step <span class="op">=</span>  <span class="va">fauna</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time_step</span><span class="op">)</span></span></code></pre></div>
<p>Now though, consider a different scenario. Here the tunas still slightly prefer their same nearshore habitat, but now the shortfin mako population primarily lives farther offshore. We will first simulate that population without the MPA, and then assess the effects of the exact same MPA on this new scenario.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">mako_habitat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">.3</span> <span class="op">*</span> <span class="va">resolution</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># create a fauna object, which is a list of lists</span></span>
<span></span>
<span><span class="va">fauna</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"Yellowfin Tuna"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      scientific_name <span class="op">=</span> <span class="st">"Thunnus albacares"</span>,</span>
<span>      base_habitat <span class="op">=</span> <span class="va">yft_habitat</span>, <span class="co"># pass habitat as lists</span></span>
<span>      recruit_habitat <span class="op">=</span> <span class="va">yft_habitat</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fl">4</span>, <span class="co"># standard deviation of the number of patches moved by adults</span></span>
<span>      fished_depletion <span class="op">=</span> <span class="fl">.4</span>, <span class="co"># desired equilibrium depletion with fishing (1 = unfished, 0 = extinct),</span></span>
<span>      rec_form <span class="op">=</span> <span class="fl">1</span>, <span class="co"># recruitment form, where 1 implies local recruitment</span></span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      init_explt <span class="op">=</span> <span class="fl">0.12</span>, </span>
<span>      explt_type <span class="op">=</span> <span class="st">"f"</span></span>
<span>      <span class="op">)</span>,</span>
<span>    <span class="st">"Shortfin Mako"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      scientific_name <span class="op">=</span> <span class="st">"Isurus oxyrinchus"</span>,</span>
<span>      base_habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mako_habitat</span><span class="op">)</span>, <span class="co"># pass habitat as lists</span></span>
<span>      recruit_habitat <span class="op">=</span> <span class="va">mako_habitat</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fl">3</span>,</span>
<span>      fished_depletion <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>      rec_form <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      burn_years <span class="op">=</span> <span class="fl">200</span>,</span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      init_explt <span class="op">=</span> <span class="fl">.12</span>, </span>
<span>      explt_type <span class="op">=</span> <span class="st">"f"</span>,</span>
<span>      fec_form <span class="op">=</span> <span class="st">"pups"</span>,</span>
<span>      pups <span class="op">=</span> <span class="fl">2</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">fauna</span><span class="op">$</span><span class="va">`Shortfin Mako`</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="100%"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tune_fleets.html">tune_fleets</a></span><span class="op">(</span><span class="va">fauna</span>, <span class="va">fleets</span>, tune_type <span class="op">=</span> <span class="va">tune_type</span><span class="op">)</span> <span class="co"># tunes the catchability by fleet to achieve target depletion</span></span>
<span></span>
<span><span class="co"># run simulations</span></span>
<span></span>
<span><span class="co"># run the simulation using marlin::simmar</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">offshore</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simmar.html">simmar</a></span><span class="op">(</span>fauna <span class="op">=</span> <span class="va">fauna</span>,</span>
<span>                  fleets <span class="op">=</span> <span class="va">fleets</span>,</span>
<span>                  years <span class="op">=</span> <span class="va">years</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 0.3850229 secs</span></span>
<span>  </span>
<span><span class="va">proc_offshore</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/process_marlin.html">process_marlin</a></span><span class="op">(</span><span class="va">offshore</span>, time_step <span class="op">=</span>  <span class="va">fauna</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time_step</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">offshore_mpa_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simmar.html">simmar</a></span><span class="op">(</span></span>
<span>  fauna <span class="op">=</span> <span class="va">fauna</span>,</span>
<span>  fleets <span class="op">=</span> <span class="va">fleets</span>,</span>
<span>  years <span class="op">=</span> <span class="va">years</span>,</span>
<span>  manager <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mpas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>locations <span class="op">=</span> <span class="va">mpa_locations</span>,</span>
<span>              mpa_year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">years</span> <span class="op">*</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 0.390085 secs</span></span>
<span></span>
<span></span>
<span><span class="va">proc_offshore_mpa</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/process_marlin.html">process_marlin</a></span><span class="op">(</span><span class="va">offshore_mpa_sim</span>, time_step <span class="op">=</span>  <span class="va">fauna</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time_step</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span></span>
<span>  `MPA: Sharks Offshore` <span class="op">=</span> <span class="va">proc_offshore_mpa</span>,</span>
<span>  `No MPA: Sharks Nearshore` <span class="op">=</span> <span class="va">proc_nearshore</span>,</span>
<span>  `MPA: Sharks Nearshore` <span class="op">=</span> <span class="va">proc_nearshore_mpa</span>,</span>
<span>  steps_to_plot <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  plot_var <span class="op">=</span> <span class="st">"ssb"</span>,</span>
<span>  max_scale <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-13-1.png" width="100%"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span></span>
<span>  `MPA: Sharks Offshore` <span class="op">=</span> <span class="va">proc_offshore_mpa</span>,</span>
<span>  `Sharks Nearshore` <span class="op">=</span> <span class="va">proc_nearshore</span>,</span>
<span>  `Sharks Offshore` <span class="op">=</span> <span class="va">proc_offshore</span>,</span>
<span>  `MPA: Sharks Nearshore` <span class="op">=</span> <span class="va">proc_nearshore_mpa</span>,</span>
<span>  plot_var <span class="op">=</span> <span class="st">"ssb"</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"space"</span>,</span>
<span>  steps_to_plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">years</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Spawning Biomass"</span>, guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html" class="external-link">guide_colorbar</a></span><span class="op">(</span>barwidth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">13</span>, <span class="st">"lines"</span><span class="op">)</span>, frame.colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-14-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="defacto-mpas-through-bycatch-penalties">Defacto MPAs through bycatch penalties<a class="anchor" aria-label="anchor" href="#defacto-mpas-through-bycatch-penalties"></a>
</h2>
<p>We can also run a case where prices for shortfin mako are negative creating <em>de facto</em> MPAs, by imposing a severe negative price on shortfin mako that causes the fishing fleet to avoid that area.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="va">tune_type</span> <span class="op">&lt;-</span> <span class="st">"explt"</span></span>
<span></span>
<span><span class="co"># make up some habitat</span></span>
<span></span>
<span><span class="va">yft_habitat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="fl">.05</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">mako_habitat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="va">x</span> <span class="op">&gt;</span> <span class="fl">12</span> <span class="op">&amp;</span> <span class="va">y</span> <span class="op">&gt;</span><span class="fl">12</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># create a fauna object, which is a list of lists</span></span>
<span></span>
<span><span class="va">fauna</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"Yellowfin Tuna"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      scientific_name <span class="op">=</span> <span class="st">"Thunnus albacares"</span>,</span>
<span>      base_habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">yft_habitat</span><span class="op">)</span>, </span>
<span>      recruit_habitat <span class="op">=</span> <span class="va">yft_habitat</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fl">4</span>, </span>
<span>      fished_depletion <span class="op">=</span> <span class="fl">.4</span>, </span>
<span>      rec_form <span class="op">=</span> <span class="fl">1</span>, </span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      init_explt <span class="op">=</span> <span class="fl">0.12</span>, </span>
<span>      explt_type <span class="op">=</span> <span class="st">"f"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="st">"Shortfin Mako"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      scientific_name <span class="op">=</span> <span class="st">"Isurus oxyrinchus"</span>,</span>
<span>      base_habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mako_habitat</span><span class="op">)</span>, </span>
<span>      recruit_habitat <span class="op">=</span> <span class="va">mako_habitat</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fl">3</span>,</span>
<span>      fished_depletion <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>      rec_form <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      burn_years <span class="op">=</span> <span class="fl">200</span>,</span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      init_explt <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>      explt_type <span class="op">=</span> <span class="st">"f"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># create a fleets object, accounting a negative price to shortfin makos</span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"longline"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_fleet.html">create_fleet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  `Yellowfin Tuna` <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>    critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">`Yellowfin Tuna`</span>,</span>
<span>    price <span class="op">=</span> <span class="fl">100</span>, <span class="co"># price per unit weight</span></span>
<span>    sel_form <span class="op">=</span> <span class="st">"logistic"</span>, <span class="co"># selectivity form, one of logistic or dome</span></span>
<span>    sel_start <span class="op">=</span> <span class="fl">.3</span>, <span class="co"># percentage of length at maturity that selectivity starts</span></span>
<span>    sel_delta <span class="op">=</span> <span class="fl">.1</span>, <span class="co"># additional percentage of sel_start where selectivity asymptotes</span></span>
<span>    catchability <span class="op">=</span> <span class="fl">.01</span>, <span class="co"># overwritten by tune_fleet but can be set manually here</span></span>
<span>    p_explt <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span>,</span>
<span>  `Shortfin Mako` <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>    critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">`Shortfin Mako`</span>,</span>
<span>    price <span class="op">=</span> <span class="op">-</span><span class="fl">20000</span>,</span>
<span>    sel_form <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>    sel_start <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>    sel_delta <span class="op">=</span> <span class="fl">.01</span>,</span>
<span>    catchability <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    p_explt <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span><span class="op">)</span>,</span>
<span>  mpa_response <span class="op">=</span> <span class="st">"stay"</span>,</span>
<span>  base_effort <span class="op">=</span> <span class="va">resolution</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>  resolution  <span class="op">=</span> <span class="va">resolution</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tune_fleets.html">tune_fleets</a></span><span class="op">(</span><span class="va">fauna</span>, <span class="va">fleets</span>, tune_type <span class="op">=</span> <span class="va">tune_type</span><span class="op">)</span> <span class="co"># tunes the catchability by fleet to achieve target depletion</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 0.798255 secs</span></span>
<span></span>
<span><span class="co"># run simulations</span></span>
<span></span>
<span><span class="co"># run the simulation using marlin::simmar</span></span>
<span><span class="va">negative_prices</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simmar.html">simmar</a></span><span class="op">(</span>fauna <span class="op">=</span> <span class="va">fauna</span>,</span>
<span>                          fleets <span class="op">=</span> <span class="va">fleets</span>,</span>
<span>                          years <span class="op">=</span> <span class="va">years</span><span class="op">)</span></span>
<span></span>
<span><span class="va">proc_negative_prices</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/process_marlin.html">process_marlin</a></span><span class="op">(</span><span class="va">negative_prices</span>, time_step <span class="op">=</span>  <span class="va">fauna</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time_step</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span></span>
<span>  `De-Facto MPA` <span class="op">=</span> <span class="va">proc_negative_prices</span>,</span>
<span>  plot_var <span class="op">=</span> <span class="st">"ssb"</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"space"</span>,</span>
<span>  steps_to_plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">25</span>,<span class="fl">49</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-16-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="repo-naviation">Repo Naviation<a class="anchor" aria-label="anchor" href="#repo-naviation"></a>
</h2>
<p>The core wrapper function is located in R/simmar.R. This function keeps track of each of the populations and fleets.</p>
<p>The actual population models are found in src/fish_model.cpp. Additional modules will be put in there as they are developed</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/danovando/marlin/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing marlin</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Dan Ovando <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-2120-7345" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dan Ovando.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
