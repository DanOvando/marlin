<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Fast simulation of marine fauna and fisheries. Runs multiple (independent) age structured species simultaneously in 2D">
<title>Simulation of Ocean Fisheries • marlin</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Simulation of Ocean Fisheries">
<meta property="og:description" content="Fast simulation of marine fauna and fisheries. Runs multiple (independent) age structured species simultaneously in 2D">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">marlin</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/danovando/marlin/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="marlin">marlin<a class="anchor" aria-label="anchor" href="#marlin"></a>
</h1></div>
<!-- badges: start -->
<!-- [![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental) -->
<!-- [![CRAN status](https://www.r-pkg.org/badges/version/mar)](https://CRAN.R-project.org/package=mar) -->
<!-- badges: end -->
<p><code>marlin</code> is a package for efficiently running simulations of marine fauna and fisheries. It is an age-structured population model of different (independent) animal types in a 2D system with capacity for multiple fishing fleets with technical interactions across fleets and species.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version from <a href="https://github.com/" class="external-link">GitHub</a> using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"DanOvando/marlin"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="repo-naviation">Repo Naviation<a class="anchor" aria-label="anchor" href="#repo-naviation"></a>
</h2>
<p>The core wrapper function is located in R/simmar.R. This function keeps track of each of the populations and fleets.</p>
<p>The actual population models are found in src/fish_model.cpp. Additional modules will be put in there as they are developed</p>
<div class="section level3">
<h3 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h3>
<p>Make sure you try the install with a fresh R session (go to “Session&gt;Restart R” to make sure)</p>
<p>If you run into an error, first off try updating your R packages. From there….</p>
<p>If your version of R is lower than 3.5, you might want to consider updating R itself. Updating from 3.51 to 3.52 shouldn’t be any hassle. BIG WARNING THOUGH, updating from say R 3.1 to 3.5 is a major update, and you’ll lose all your installed packages in the process. I recommend following the instructions <a href="https://www.datascienceriot.com/r/upgrade-R-packages/" class="external-link">here</a> to deal with that, but even with that fix it can take a while, so I don’t recommend doing a major R update if you’re on a deadline. There are also packages to help you with this process, specifically <a href="https://github.com/talgalili/installr/issues" class="external-link"><code>installR</code></a> for Windows and <a href="https://github.com/AndreaCirilloAC/updateR" class="external-link"><code>updateR</code></a> for Mac.</p>
<p>From there…</p>
<ul>
<li>On Windows, make sure you have the appropriate version of Rtools installed (<a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">here</a>), most likely Rtools35 if you have R version 3.3 or higher
<ul>
<li>Make sure that you select the box that says something about adding Rtools to the PATH variable</li>
</ul>
</li>
<li>On macOS, there might be some issues with the your compiler, particularly if your version of R is less than 4.0.0.</li>
</ul>
<p>If you get an error that says something like <code>clang: error: unsupported option '-fopenmp'</code>, follow the instructions <a href="https://thecoatlessprofessor.com/programming/cpp/r-compiler-tools-for-rcpp-on-macos-before-r-4.0.0/" class="external-link">here</a></p>
<p>Once you’ve tried those, restart your computer and try running</p>
<p>Below are a bunch of examples showing what <code>marlin</code> can do</p>
</div>
</div>
<div class="section level2">
<h2 id="simple-example">Simple Example<a class="anchor" aria-label="anchor" href="#simple-example"></a>
</h2>
<p>Let’s start with a simple one-fleet one-critter example to illustrate the various options in <code>marlin</code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://danovando.github.io/marlin/">marlin</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</span></span>
<span><span class="co">#&gt; ✔ ggplot2 3.3.6     ✔ purrr   0.3.4</span></span>
<span><span class="co">#&gt; ✔ tibble  3.1.8     ✔ dplyr   1.0.9</span></span>
<span><span class="co">#&gt; ✔ tidyr   1.2.0     ✔ stringr 1.4.0</span></span>
<span><span class="co">#&gt; ✔ readr   2.1.2     ✔ forcats 0.5.1</span></span>
<span><span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span></span>
<span><span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>dplyr.summarise.inform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu">marlin</span><span class="fu">::</span><span class="fu"><a href="reference/theme_marlin.html">theme_marlin</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">42</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">resolution</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co"># resolution is in squared patches, so 20 implies a 20X20 system, i.e. 400 patches </span></span>
<span></span>
<span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="va">seasons</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">time_step</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">seasons</span></span>
<span></span>
<span><span class="va">steps</span> <span class="op">&lt;-</span> <span class="va">years</span> <span class="op">*</span> <span class="va">seasons</span></span>
<span></span>
<span><span class="va">fauna</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"bigeye"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      common_name <span class="op">=</span> <span class="st">"bigeye tuna"</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fl">10</span>,</span>
<span>      rec_form <span class="op">=</span> <span class="fl">3</span>,</span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      fished_depletion <span class="op">=</span> <span class="fl">.25</span>,</span>
<span>      resolution <span class="op">=</span> <span class="va">resolution</span>,</span>
<span>      steepness <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>      ssb0 <span class="op">=</span> <span class="fl">1000</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; ══  1 queries  ═══════════════</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Retrieving data for taxon 'bigeye tuna'</span></span>
<span><span class="co">#&gt; ✔  Found:  bigeye+tuna[Common Name]</span></span>
<span><span class="co">#&gt; ══  Results  ═════════════════</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • Total: 1 </span></span>
<span><span class="co">#&gt; • Found: 1 </span></span>
<span><span class="co">#&gt; • Not Found: 0</span></span>
<span></span>
<span><span class="co"># create a fleets object, which is a list of lists (of lists). Each fleet has one element, </span></span>
<span><span class="co"># with lists for each species inside there. Price specifies the price per unit weight of that </span></span>
<span><span class="co"># species for that fleet</span></span>
<span><span class="co"># sel_form can be one of logistic or dome</span></span>
<span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"longline"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_fleet.html">create_fleet</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"bigeye"</span> <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>        critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">bigeye</span>,</span>
<span>        price <span class="op">=</span> <span class="fl">10</span>,</span>
<span>        sel_form <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>        sel_start <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        sel_delta <span class="op">=</span> <span class="fl">.01</span>,</span>
<span>        catchability <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        p_explt <span class="op">=</span> <span class="fl">1</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    base_effort <span class="op">=</span> <span class="va">resolution</span> <span class="op">^</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tune_fleets.html">tune_fleets</a></span><span class="op">(</span><span class="va">fauna</span>, <span class="va">fleets</span>, tune_type <span class="op">=</span> <span class="st">"depletion"</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 4.380098 secs</span></span>
<span></span>
<span></span>
<span><span class="va">fauna</span><span class="op">$</span><span class="va">bigeye</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-1.png" width="100%"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simmar.html">simmar</a></span><span class="op">(</span>fauna <span class="op">=</span> <span class="va">fauna</span>,</span>
<span>                  fleets <span class="op">=</span> <span class="va">fleets</span>,</span>
<span>                  years <span class="op">=</span> <span class="va">years</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 0.03277588 secs</span></span></code></pre></div>
<p>we can then use <code>process_marlin</code> and <code>plot_marlin</code> to examine the simulation</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">processed_marlin</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/process_marlin.html">process_marlin</a></span><span class="op">(</span>sim <span class="op">=</span> <span class="va">sim</span>, time_step <span class="op">=</span> <span class="va">time_step</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span>, plot_var <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-2.png" width="100%"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span>, plot_var <span class="op">=</span> <span class="st">"n"</span>, plot_type <span class="op">=</span> <span class="st">"length"</span>, fauna <span class="op">=</span> <span class="va">fauna</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in plot_marlin(processed_marlin, plot_var = "n", plot_type = "length", :</span></span>
<span><span class="co">#&gt; trying to plot too many steps at once, cutting down to 10</span></span>
<span><span class="co">#&gt; dropping recruits from plot since drop_recruits = TRUE</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-3.png" width="100%"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span>, plot_var <span class="op">=</span> <span class="st">"ssb"</span>, plot_type <span class="op">=</span> <span class="st">"space"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in plot_marlin(processed_marlin, plot_var = "ssb", plot_type = "space"):</span></span>
<span><span class="co">#&gt; Can only plot one time step for spatial plots, defaulting to last of the</span></span>
<span><span class="co">#&gt; supplied steps</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-4.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="simple-example-seasonal-habitat-and-movement-and-spatial-q">Simple Example: seasonal habitat and movement and spatial q<a class="anchor" aria-label="anchor" href="#simple-example-seasonal-habitat-and-movement-and-spatial-q"></a>
</h2>
<p>Now let’s add in different adult habitats by season, different movement rates by season, specified recruitment habitat, and a spatial dimension to catchability, and quarterly time steps</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">seasons</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span></span>
<span><span class="va">time_step</span> <span class="op">&lt;-</span>  <span class="fl">1</span> <span class="op">/</span> <span class="va">seasons</span></span>
<span></span>
<span><span class="va">bigeye_habitat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">+</span> <span class="va">y</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span>, <span class="fl">300</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">bigeye_habitat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">^</span> <span class="fl">.2</span> <span class="op">+</span> <span class="va">y</span> <span class="op">^</span> <span class="fl">.2</span><span class="op">)</span>, <span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bigeye_q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">resolution</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">fauna</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"bigeye"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      common_name <span class="op">=</span> <span class="st">"bigeye tuna"</span>,</span>
<span>      base_habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">bigeye_habitat</span>,<span class="va">bigeye_habitat2</span><span class="op">)</span>,</span>
<span>      season_blocks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="fl">.1</span><span class="op">)</span><span class="op">)</span>, <span class="co"># standard deviation of the number of patches moved by adults</span></span>
<span>      rec_form <span class="op">=</span> <span class="fl">2</span>,</span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      init_explt <span class="op">=</span>  <span class="fl">1</span>,</span>
<span>     explt_type <span class="op">=</span> <span class="st">"f"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; ══  1 queries  ═══════════════</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Retrieving data for taxon 'bigeye tuna'</span></span>
<span><span class="co">#&gt; ✔  Found:  bigeye+tuna[Common Name]</span></span>
<span><span class="co">#&gt; ══  Results  ═════════════════</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • Total: 1 </span></span>
<span><span class="co">#&gt; • Found: 1 </span></span>
<span><span class="co">#&gt; • Not Found: 0</span></span>
<span></span>
<span></span>
<span><span class="co"># create a fleets object, which is a list of lists (of lists). Each fleet has one element, </span></span>
<span><span class="co"># with lists for each species inside there. Price specifies the price per unit weight of that </span></span>
<span><span class="co"># species for that fleet</span></span>
<span><span class="co"># sel_form can be one of logistic or dome</span></span>
<span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"longline"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_fleet.html">create_fleet</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"bigeye"</span> <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>        critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">bigeye</span>,</span>
<span>        price <span class="op">=</span> <span class="fl">10</span>,</span>
<span>        sel_form <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>        sel_start <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        sel_delta <span class="op">=</span> <span class="fl">.01</span>,</span>
<span>        catchability <span class="op">=</span> <span class="fl">1e-3</span>,</span>
<span>        p_explt <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        spatial_catchability <span class="op">=</span> <span class="cn">NA</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    base_effort <span class="op">=</span> <span class="va">resolution</span> <span class="op">^</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tune_fleets.html">tune_fleets</a></span><span class="op">(</span><span class="va">fauna</span>, <span class="va">fleets</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 0.6998498 secs</span></span>
<span></span>
<span></span>
<span><span class="va">fauna</span><span class="op">$</span><span class="va">bigeye</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="100%"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simmar.html">simmar</a></span><span class="op">(</span>fauna <span class="op">=</span> <span class="va">fauna</span>,</span>
<span>                  fleets <span class="op">=</span> <span class="va">fleets</span>,</span>
<span>                  years <span class="op">=</span> <span class="va">years</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 0.1917739 secs</span></span>
<span>  </span>
<span></span>
<span><span class="va">processed_marlin</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/process_marlin.html">process_marlin</a></span><span class="op">(</span>sim <span class="op">=</span> <span class="va">sim2</span>, time_step <span class="op">=</span> <span class="va">time_step</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-2.png" width="100%"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span>, plot_var <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-3.png" width="100%"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span>, plot_var <span class="op">=</span> <span class="st">"n"</span>, plot_type <span class="op">=</span> <span class="st">"length"</span>, fauna <span class="op">=</span> <span class="va">fauna</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in plot_marlin(processed_marlin, plot_var = "n", plot_type = "length", :</span></span>
<span><span class="co">#&gt; trying to plot too many steps at once, cutting down to 10</span></span>
<span><span class="co">#&gt; dropping recruits from plot since drop_recruits = TRUE</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-4.png" width="100%"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span>, plot_var <span class="op">=</span> <span class="st">"ssb"</span>, plot_type <span class="op">=</span> <span class="st">"space"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in plot_marlin(processed_marlin, plot_var = "ssb", plot_type = "space"):</span></span>
<span><span class="co">#&gt; Can only plot one time step for spatial plots, defaulting to last of the</span></span>
<span><span class="co">#&gt; supplied steps</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-5.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="two-species-and-two-fleets-with-bells-and-whistles">Two Species and two fleets with bells and whistles<a class="anchor" aria-label="anchor" href="#two-species-and-two-fleets-with-bells-and-whistles"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">seasons</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span></span>
<span><span class="va">steps</span> <span class="op">&lt;-</span> <span class="va">years</span> <span class="op">*</span> <span class="va">seasons</span></span>
<span></span>
<span><span class="va">time_step</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">seasons</span></span>
<span><span class="co"># for now make up some habitat</span></span>
<span></span>
<span></span>
<span><span class="va">skipjack_habitat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">+</span> <span class="va">y</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span>, <span class="fl">20</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">bigeye_habitat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">+</span> <span class="va">y</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span>, <span class="fl">300</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">bigeye_habitat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">^</span> <span class="fl">.2</span> <span class="op">+</span> <span class="va">y</span> <span class="op">^</span> <span class="fl">.2</span><span class="op">)</span>, <span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fauna</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"skipjack"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      scientific_name <span class="op">=</span> <span class="st">"Katsuwonus pelamis"</span>,</span>
<span>      base_habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">skipjack_habitat</span>, <span class="va">skipjack_habitat</span><span class="op">)</span>, <span class="co"># pass habitat as lists</span></span>
<span>      season_blocks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>, <span class="co"># seasons each habitat apply to</span></span>
<span>      recruit_habitat <span class="op">=</span> <span class="va">skipjack_habitat</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fl">2</span>, <span class="co"># standard deviation of the number of patches moved by adults</span></span>
<span>      fished_depletion <span class="op">=</span> <span class="fl">.6</span>, <span class="co"># desired equilibrium depletion with fishing (1 = unfished, 0 = extinct),</span></span>
<span>      rec_form <span class="op">=</span> <span class="fl">1</span>, <span class="co"># recruitment form, where 1 implies local recruitment</span></span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      init_explt <span class="op">=</span> <span class="fl">0.2</span>, </span>
<span>      explt_type <span class="op">=</span> <span class="st">"f"</span></span>
<span>      <span class="op">)</span>,</span>
<span>    <span class="st">"bigeye"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      common_name <span class="op">=</span> <span class="st">"bigeye tuna"</span>,</span>
<span>      base_habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">bigeye_habitat</span>, <span class="va">bigeye_habitat2</span><span class="op">)</span>, <span class="co"># pass habitat as lists</span></span>
<span>      season_blocks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>, <span class="co"># seasons each habitat apply to</span></span>
<span>      recruit_habitat <span class="op">=</span> <span class="va">bigeye_habitat</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      fished_depletion <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>      rec_form <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      init_explt <span class="op">=</span> <span class="fl">0.3</span>, </span>
<span>      explt_type <span class="op">=</span> <span class="st">"f"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; ══  1 queries  ═══════════════</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Retrieving data for taxon 'bigeye tuna'</span></span>
<span><span class="co">#&gt; ✔  Found:  bigeye+tuna[Common Name]</span></span>
<span><span class="co">#&gt; ══  Results  ═════════════════</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • Total: 1 </span></span>
<span><span class="co">#&gt; • Found: 1 </span></span>
<span><span class="co">#&gt; • Not Found: 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 1.107228 secs</span></span>
<span></span>
<span><span class="co"># create a fleets object, which is a list of lists (of lists). Each fleet has one element, </span></span>
<span><span class="co"># with lists for each species inside there. Price specifies the price per unit weight of that </span></span>
<span><span class="co"># species for that fleet</span></span>
<span><span class="co"># sel_form can be one of logistic or dome</span></span>
<span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"longline"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_fleet.html">create_fleet</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       <span class="st">"skipjack"</span> <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>        critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">skipjack</span>,</span>
<span>        price <span class="op">=</span> <span class="fl">100</span>,</span>
<span>        <span class="co"># price per unit weight</span></span>
<span>        sel_form <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>        <span class="co"># selectivity form, one of logistic or dome</span></span>
<span>        sel_start <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>        <span class="co"># percentage of length at maturity that selectivity starts</span></span>
<span>        sel_delta <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>        <span class="co"># additional percentage of sel_start where selectivity asymptotes</span></span>
<span>        catchability <span class="op">=</span> <span class="fl">.01</span>,</span>
<span>        <span class="co"># overwritten by tune_fleet but can be set manually here</span></span>
<span>        p_explt <span class="op">=</span> <span class="fl">1</span></span>
<span>      <span class="op">)</span>,</span>
<span>       <span class="st">"bigeye"</span> <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>        critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">bigeye</span>,</span>
<span>        price <span class="op">=</span> <span class="fl">10</span>,</span>
<span>        sel_form <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>        sel_start <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>        sel_delta <span class="op">=</span> <span class="fl">.01</span>,</span>
<span>        catchability <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        p_explt <span class="op">=</span> <span class="fl">1</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    base_effort <span class="op">=</span> <span class="va">resolution</span> <span class="op">^</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="st">"purseseine"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_fleet.html">create_fleet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    skipjack <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>      critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">skipjack</span>,</span>
<span>      price <span class="op">=</span> <span class="fl">100</span>,</span>
<span>      sel_form <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>      sel_start <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>      sel_delta <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>      catchability <span class="op">=</span> <span class="fl">.01</span>,</span>
<span>      p_explt <span class="op">=</span> <span class="fl">0.9</span></span>
<span>    <span class="op">)</span>,</span>
<span>    bigeye <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>      critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">bigeye</span>,</span>
<span>      price <span class="op">=</span> <span class="fl">100</span>,</span>
<span>      sel_form <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>      sel_start <span class="op">=</span> <span class="fl">.25</span>,</span>
<span>      sel_delta <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>      catchability <span class="op">=</span> <span class="fl">.01</span>,</span>
<span>      p_explt <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  base_effort <span class="op">=</span> <span class="va">resolution</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tune_fleets.html">tune_fleets</a></span><span class="op">(</span><span class="va">fauna</span>, <span class="va">fleets</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 1.120107 secs</span></span>
<span></span>
<span></span>
<span><span class="co"># run simulations</span></span>
<span></span>
<span><span class="co"># run the simulation using marlin::simmar</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simmar.html">simmar</a></span><span class="op">(</span>fauna <span class="op">=</span> <span class="va">fauna</span>,</span>
<span>                  fleets <span class="op">=</span> <span class="va">fleets</span>,</span>
<span>                  years <span class="op">=</span> <span class="va">years</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 0.628619 secs</span></span>
<span><span class="co"># a &lt;- Sys.time()</span></span>
<span></span>
<span><span class="va">processed_marlin</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/process_marlin.html">process_marlin</a></span><span class="op">(</span>sim <span class="op">=</span> <span class="va">sim3</span>, time_step <span class="op">=</span> <span class="va">time_step</span>, keep_age <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Sys.time() - a</span></span>
<span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example-1.png" width="100%"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span>, plot_var <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example-2.png" width="100%"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span>, plot_var <span class="op">=</span> <span class="st">"n"</span>, plot_type <span class="op">=</span> <span class="st">"length"</span>, fauna <span class="op">=</span> <span class="va">fauna</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in plot_marlin(processed_marlin, plot_var = "n", plot_type = "length", :</span></span>
<span><span class="co">#&gt; trying to plot too many steps at once, cutting down to 10</span></span>
<span><span class="co">#&gt; dropping recruits from plot since drop_recruits = TRUE</span></span></code></pre></div>
<p><img src="reference/figures/README-example-3.png" width="100%"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span><span class="va">processed_marlin</span>, plot_var <span class="op">=</span> <span class="st">"ssb"</span>, plot_type <span class="op">=</span> <span class="st">"space"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in plot_marlin(processed_marlin, plot_var = "ssb", plot_type = "space"):</span></span>
<span><span class="co">#&gt; Can only plot one time step for spatial plots, defaulting to last of the</span></span>
<span><span class="co">#&gt; supplied steps</span></span></code></pre></div>
<p><img src="reference/figures/README-example-4.png" width="100%"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span>  <span class="va">e_p_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">sim3</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sim3</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>,<span class="st">"e_p_fl"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"critter"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">critter</span>, names_to <span class="op">=</span> <span class="st">"fleet"</span>, values_to <span class="op">=</span> <span class="st">"effort"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">critter</span>, <span class="va">fleet</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>patch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">effort</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">fleet</span>, <span class="va">patch</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>effort <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">effort</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="evaluating-mpas">Evaluating MPAs<a class="anchor" aria-label="anchor" href="#evaluating-mpas"></a>
</h2>
<p>Now let’s compare the effect of an MPA on two species</p>
<p>sharks live nearshore</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://danovando.github.io/marlin/">marlin</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu">marlin</span><span class="fu">::</span><span class="fu"><a href="reference/theme_marlin.html">theme_marlin</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">resolution</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># resolution is in squared patches, so 20 implies a 20X20 system, i.e. 400 patches </span></span>
<span></span>
<span><span class="va">seasons</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span></span>
<span><span class="va">tune_type</span> <span class="op">&lt;-</span> <span class="st">"depletion"</span></span>
<span></span>
<span><span class="va">steps</span> <span class="op">&lt;-</span> <span class="va">years</span> <span class="op">*</span> <span class="va">seasons</span></span>
<span></span>
<span><span class="co"># for now make up some habitat</span></span>
<span></span>
<span><span class="va">yft_habitat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="fl">.05</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span> </span>
<span></span>
<span><span class="va">mako_habitat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">resolution</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># create a fauna object, which is a list of lists</span></span>
<span><span class="va">fauna</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"Yellowfin Tuna"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      scientific_name <span class="op">=</span> <span class="st">"Thunnus albacares"</span>,</span>
<span>      base_habitat <span class="op">=</span> <span class="va">yft_habitat</span>, <span class="co"># pass habitat as lists</span></span>
<span>      recruit_habitat <span class="op">=</span> <span class="va">yft_habitat</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fl">4</span>, <span class="co"># standard deviation of the number of patches moved by adults</span></span>
<span>      fished_depletion <span class="op">=</span> <span class="fl">.4</span>, <span class="co"># desired equilibrium depletion with fishing (1 = unfished, 0 = extinct),</span></span>
<span>      rec_form <span class="op">=</span> <span class="fl">1</span>, <span class="co"># recruitment form, where 1 implies local recruitment</span></span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      init_explt <span class="op">=</span> <span class="fl">0.12</span>, </span>
<span>      explt_type <span class="op">=</span> <span class="st">"f"</span></span>
<span>      <span class="op">)</span>,</span>
<span>    <span class="st">"Shortfin Mako"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      scientific_name <span class="op">=</span> <span class="st">"Isurus oxyrinchus"</span>,</span>
<span>      base_habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mako_habitat</span><span class="op">)</span>, <span class="co"># pass habitat as lists</span></span>
<span>      recruit_habitat <span class="op">=</span> <span class="va">mako_habitat</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fl">3</span>,</span>
<span>      fished_depletion <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>      rec_form <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      burn_years <span class="op">=</span> <span class="fl">200</span>,</span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      init_explt <span class="op">=</span> <span class="fl">.12</span>, </span>
<span>      explt_type <span class="op">=</span> <span class="st">"f"</span>,</span>
<span>      fec_form <span class="op">=</span> <span class="st">"pups"</span>,</span>
<span>      pups <span class="op">=</span> <span class="fl">2</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">fauna</span><span class="op">$</span><span class="va">`Shortfin Mako`</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a fleets object, which is a list of lists (of lists). Each fleet has one element, </span></span>
<span><span class="co"># with lists for each species inside there. Price specifies the price per unit weight of that </span></span>
<span><span class="co"># species for that fleet</span></span>
<span><span class="co"># sel_form can be one of logistic or dome</span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"longline"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_fleet.html">create_fleet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  `Yellowfin Tuna` <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>    critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">`Yellowfin Tuna`</span>,</span>
<span>    price <span class="op">=</span> <span class="fl">100</span>, <span class="co"># price per unit weight</span></span>
<span>    sel_form <span class="op">=</span> <span class="st">"logistic"</span>, <span class="co"># selectivity form, one of logistic or dome</span></span>
<span>    sel_start <span class="op">=</span> <span class="fl">.3</span>, <span class="co"># percentage of length at maturity that selectivity starts</span></span>
<span>    sel_delta <span class="op">=</span> <span class="fl">.1</span>, <span class="co"># additional percentage of sel_start where selectivity asymptotes</span></span>
<span>    catchability <span class="op">=</span> <span class="fl">.01</span>, <span class="co"># overwritten by tune_fleet but can be set manually here</span></span>
<span>    p_explt <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span>,</span>
<span>  `Shortfin Mako` <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>    critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">`Shortfin Mako`</span>,</span>
<span>    price <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    sel_form <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>    sel_start <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>    sel_delta <span class="op">=</span> <span class="fl">.01</span>,</span>
<span>    catchability <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    p_explt <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span><span class="op">)</span>,</span>
<span>  mpa_response <span class="op">=</span> <span class="st">"stay"</span>,</span>
<span>  base_effort <span class="op">=</span> <span class="va">resolution</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tune_fleets.html">tune_fleets</a></span><span class="op">(</span><span class="va">fauna</span>, <span class="va">fleets</span>, tune_type <span class="op">=</span> <span class="va">tune_type</span><span class="op">)</span> <span class="co"># tunes the catchability by fleet to achieve target depletion</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 19.05167 secs</span></span>
<span></span>
<span><span class="co"># run simulations</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nearshore</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simmar.html">simmar</a></span><span class="op">(</span>fauna <span class="op">=</span> <span class="va">fauna</span>,</span>
<span>                  fleets <span class="op">=</span> <span class="va">fleets</span>,</span>
<span>                  years <span class="op">=</span> <span class="va">years</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 0.4026518 secs</span></span>
<span>  </span>
<span><span class="va">proc_nearshore</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/process_marlin.html">process_marlin</a></span><span class="op">(</span><span class="va">nearshore</span>, time_step <span class="op">=</span>  <span class="va">fauna</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time_step</span><span class="op">)</span></span></code></pre></div>
<p>create an MPA</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="co">#specify some MPA locations</span></span>
<span><span class="va">mpa_locations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>mpa <span class="op">=</span> <span class="va">x</span> <span class="op">&gt;</span> <span class="fl">15</span> <span class="op">&amp;</span> <span class="va">y</span> <span class="op">&lt;</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mpa_locations</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, fill <span class="op">=</span> <span class="va">mpa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Accent"</span>, direction  <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, name <span class="op">=</span> <span class="st">"MPA"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Lat"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Lon"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" width="100%"></p>
<p>And now apply MPA</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nearshore_mpa</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simmar.html">simmar</a></span><span class="op">(</span></span>
<span>  fauna <span class="op">=</span> <span class="va">fauna</span>,</span>
<span>  fleets <span class="op">=</span> <span class="va">fleets</span>,</span>
<span>  years <span class="op">=</span> <span class="va">years</span>,</span>
<span>  mpas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>locations <span class="op">=</span> <span class="va">mpa_locations</span>,</span>
<span>              mpa_year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">years</span> <span class="op">*</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 0.4994051 secs</span></span>
<span></span>
<span><span class="va">proc_nearshore_mpa</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/process_marlin.html">process_marlin</a></span><span class="op">(</span><span class="va">nearshore_mpa</span>, time_step <span class="op">=</span>  <span class="va">fauna</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time_step</span><span class="op">)</span></span></code></pre></div>
<p>Now though, consider a different scenario. Here the tunas still slightly prefer their same nearshore habitat, but now the shortfin mako population primarily lives farther offshore. We will first simulate that population without the MPA, and then assess the effects of the exact same MPA on this new scenario.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">mako_habitat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">.3</span> <span class="op">*</span> <span class="va">resolution</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># create a fauna object, which is a list of lists</span></span>
<span></span>
<span><span class="va">fauna</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"Yellowfin Tuna"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      scientific_name <span class="op">=</span> <span class="st">"Thunnus albacares"</span>,</span>
<span>      base_habitat <span class="op">=</span> <span class="va">yft_habitat</span>, <span class="co"># pass habitat as lists</span></span>
<span>      recruit_habitat <span class="op">=</span> <span class="va">yft_habitat</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fl">4</span>, <span class="co"># standard deviation of the number of patches moved by adults</span></span>
<span>      fished_depletion <span class="op">=</span> <span class="fl">.4</span>, <span class="co"># desired equilibrium depletion with fishing (1 = unfished, 0 = extinct),</span></span>
<span>      rec_form <span class="op">=</span> <span class="fl">1</span>, <span class="co"># recruitment form, where 1 implies local recruitment</span></span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      init_explt <span class="op">=</span> <span class="fl">0.12</span>, </span>
<span>      explt_type <span class="op">=</span> <span class="st">"f"</span></span>
<span>      <span class="op">)</span>,</span>
<span>    <span class="st">"Shortfin Mako"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      scientific_name <span class="op">=</span> <span class="st">"Isurus oxyrinchus"</span>,</span>
<span>      base_habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mako_habitat</span><span class="op">)</span>, <span class="co"># pass habitat as lists</span></span>
<span>      recruit_habitat <span class="op">=</span> <span class="va">mako_habitat</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fl">3</span>,</span>
<span>      fished_depletion <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>      rec_form <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      burn_years <span class="op">=</span> <span class="fl">200</span>,</span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      init_explt <span class="op">=</span> <span class="fl">.12</span>, </span>
<span>      explt_type <span class="op">=</span> <span class="st">"f"</span>,</span>
<span>      fec_form <span class="op">=</span> <span class="st">"pups"</span>,</span>
<span>      pups <span class="op">=</span> <span class="fl">2</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">fauna</span><span class="op">$</span><span class="va">`Shortfin Mako`</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="100%"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tune_fleets.html">tune_fleets</a></span><span class="op">(</span><span class="va">fauna</span>, <span class="va">fleets</span>, tune_type <span class="op">=</span> <span class="va">tune_type</span><span class="op">)</span> <span class="co"># tunes the catchability by fleet to achieve target depletion</span></span>
<span></span>
<span><span class="co"># run simulations</span></span>
<span></span>
<span><span class="co"># run the simulation using marlin::simmar</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">offshore</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simmar.html">simmar</a></span><span class="op">(</span>fauna <span class="op">=</span> <span class="va">fauna</span>,</span>
<span>                  fleets <span class="op">=</span> <span class="va">fleets</span>,</span>
<span>                  years <span class="op">=</span> <span class="va">years</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 0.3822432 secs</span></span>
<span>  </span>
<span><span class="va">proc_offshore</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/process_marlin.html">process_marlin</a></span><span class="op">(</span><span class="va">offshore</span>, time_step <span class="op">=</span>  <span class="va">fauna</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time_step</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">offshore_mpa_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simmar.html">simmar</a></span><span class="op">(</span></span>
<span>  fauna <span class="op">=</span> <span class="va">fauna</span>,</span>
<span>  fleets <span class="op">=</span> <span class="va">fleets</span>,</span>
<span>  years <span class="op">=</span> <span class="va">years</span>,</span>
<span>  mpas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>locations <span class="op">=</span> <span class="va">mpa_locations</span>,</span>
<span>              mpa_year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">years</span> <span class="op">*</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 0.381577 secs</span></span>
<span></span>
<span></span>
<span><span class="va">proc_offshore_mpa</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/process_marlin.html">process_marlin</a></span><span class="op">(</span><span class="va">offshore_mpa_sim</span>, time_step <span class="op">=</span>  <span class="va">fauna</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time_step</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span></span>
<span>  `MPA: Sharks Offshore` <span class="op">=</span> <span class="va">proc_offshore_mpa</span>,</span>
<span>  `No MPA: Sharks Nearshore` <span class="op">=</span> <span class="va">proc_nearshore</span>,</span>
<span>  `MPA: Sharks Nearshore` <span class="op">=</span> <span class="va">proc_nearshore_mpa</span>,</span>
<span>  steps_to_plot <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  plot_var <span class="op">=</span> <span class="st">"ssb"</span>,</span>
<span>  max_scale <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="100%"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span></span>
<span>  `MPA: Sharks Offshore` <span class="op">=</span> <span class="va">proc_offshore_mpa</span>,</span>
<span>  `Sharks Nearshore` <span class="op">=</span> <span class="va">proc_nearshore</span>,</span>
<span>  `Sharks Offshore` <span class="op">=</span> <span class="va">proc_offshore</span>,</span>
<span>  `MPA: Sharks Nearshore` <span class="op">=</span> <span class="va">proc_nearshore_mpa</span>,</span>
<span>  plot_var <span class="op">=</span> <span class="st">"ssb"</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"space"</span>,</span>
<span>  steps_to_plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">years</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Spawning Biomass"</span>, guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html" class="external-link">guide_colorbar</a></span><span class="op">(</span>barwidth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">13</span>, <span class="st">"lines"</span><span class="op">)</span>, frame.colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span></span>
<span><span class="co">#&gt; will replace the existing scale.</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-10-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="defacto-mpas-through-bycatch-penalties">Defacto MPAs through bycatch penalties<a class="anchor" aria-label="anchor" href="#defacto-mpas-through-bycatch-penalties"></a>
</h2>
<p>We can also run a case where prices for shortfin mako are negative creating <em>de facto</em> MPAs, by imposing a severe negative price on shortfin mako that causes the fishing fleet to avoid taht area.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="va">tune_type</span> <span class="op">&lt;-</span> <span class="st">"explt"</span></span>
<span></span>
<span><span class="co"># make up some habitat</span></span>
<span></span>
<span><span class="va">yft_habitat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="fl">.05</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">mako_habitat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">resolution</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>habitat <span class="op">=</span>  <span class="va">x</span> <span class="op">&gt;</span> <span class="fl">12</span> <span class="op">&amp;</span> <span class="va">y</span> <span class="op">&gt;</span><span class="fl">12</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">y</span>, values_from <span class="op">=</span> <span class="va">habitat</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># create a fauna object, which is a list of lists</span></span>
<span></span>
<span><span class="va">fauna</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"Yellowfin Tuna"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      scientific_name <span class="op">=</span> <span class="st">"Thunnus albacares"</span>,</span>
<span>      base_habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">yft_habitat</span><span class="op">)</span>, </span>
<span>      recruit_habitat <span class="op">=</span> <span class="va">yft_habitat</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fl">4</span>, </span>
<span>      fished_depletion <span class="op">=</span> <span class="fl">.4</span>, </span>
<span>      rec_form <span class="op">=</span> <span class="fl">1</span>, </span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      init_explt <span class="op">=</span> <span class="fl">0.12</span>, </span>
<span>      explt_type <span class="op">=</span> <span class="st">"f"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="st">"Shortfin Mako"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_critter.html">create_critter</a></span><span class="op">(</span></span>
<span>      scientific_name <span class="op">=</span> <span class="st">"Isurus oxyrinchus"</span>,</span>
<span>      base_habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mako_habitat</span><span class="op">)</span>, </span>
<span>      recruit_habitat <span class="op">=</span> <span class="va">mako_habitat</span>,</span>
<span>      adult_diffusion <span class="op">=</span> <span class="fl">3</span>,</span>
<span>      fished_depletion <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>      rec_form <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      burn_years <span class="op">=</span> <span class="fl">200</span>,</span>
<span>      seasons <span class="op">=</span> <span class="va">seasons</span>,</span>
<span>      init_explt <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>      explt_type <span class="op">=</span> <span class="st">"f"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># create a fleets object, accounting a negative price to shortfin makos</span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"longline"</span> <span class="op">=</span> <span class="fu"><a href="reference/create_fleet.html">create_fleet</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  `Yellowfin Tuna` <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>    critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">`Yellowfin Tuna`</span>,</span>
<span>    price <span class="op">=</span> <span class="fl">100</span>, <span class="co"># price per unit weight</span></span>
<span>    sel_form <span class="op">=</span> <span class="st">"logistic"</span>, <span class="co"># selectivity form, one of logistic or dome</span></span>
<span>    sel_start <span class="op">=</span> <span class="fl">.3</span>, <span class="co"># percentage of length at maturity that selectivity starts</span></span>
<span>    sel_delta <span class="op">=</span> <span class="fl">.1</span>, <span class="co"># additional percentage of sel_start where selectivity asymptotes</span></span>
<span>    catchability <span class="op">=</span> <span class="fl">.01</span>, <span class="co"># overwritten by tune_fleet but can be set manually here</span></span>
<span>    p_explt <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span>,</span>
<span>  `Shortfin Mako` <span class="op">=</span> <span class="va"><a href="reference/Metier.html">Metier</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>    critter <span class="op">=</span> <span class="va">fauna</span><span class="op">$</span><span class="va">`Shortfin Mako`</span>,</span>
<span>    price <span class="op">=</span> <span class="op">-</span><span class="fl">20000</span>,</span>
<span>    sel_form <span class="op">=</span> <span class="st">"logistic"</span>,</span>
<span>    sel_start <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>    sel_delta <span class="op">=</span> <span class="fl">.01</span>,</span>
<span>    catchability <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    p_explt <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span><span class="op">)</span>,</span>
<span>  mpa_response <span class="op">=</span> <span class="st">"stay"</span>,</span>
<span>  base_effort <span class="op">=</span> <span class="va">resolution</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fleets</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/tune_fleets.html">tune_fleets</a></span><span class="op">(</span><span class="va">fauna</span>, <span class="va">fleets</span>, tune_type <span class="op">=</span> <span class="va">tune_type</span><span class="op">)</span> <span class="co"># tunes the catchability by fleet to achieve target depletion</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="va">a</span></span>
<span><span class="co">#&gt; Time difference of 0.3357971 secs</span></span>
<span></span>
<span><span class="co"># run simulations</span></span>
<span></span>
<span><span class="co"># run the simulation using marlin::simmar</span></span>
<span><span class="va">negative_prices</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simmar.html">simmar</a></span><span class="op">(</span>fauna <span class="op">=</span> <span class="va">fauna</span>,</span>
<span>                          fleets <span class="op">=</span> <span class="va">fleets</span>,</span>
<span>                          years <span class="op">=</span> <span class="va">years</span><span class="op">)</span></span>
<span></span>
<span><span class="va">proc_negative_prices</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/process_marlin.html">process_marlin</a></span><span class="op">(</span><span class="va">negative_prices</span>, time_step <span class="op">=</span>  <span class="va">fauna</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">time_step</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot_marlin.html">plot_marlin</a></span><span class="op">(</span></span>
<span>  `De-Facto MPA` <span class="op">=</span> <span class="va">proc_negative_prices</span>,</span>
<span>  plot_var <span class="op">=</span> <span class="st">"ssb"</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"space"</span>,</span>
<span>  steps_to_plot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">25</span>,<span class="fl">49</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in plot_marlin(`De-Facto MPA` = proc_negative_prices, plot_var =</span></span>
<span><span class="co">#&gt; "ssb", : Can only plot one time step for spatial plots, defaulting to last of</span></span>
<span><span class="co">#&gt; the supplied steps</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="100%"></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/danovando/marlin/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing marlin</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Dan Ovando <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-2120-7345" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dan Ovando.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
